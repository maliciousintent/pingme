extends layout
block favicon
  if offline === 0
    link(rel='icon', href='/img/ok.ico?v=2')
  else
    link(rel='icon', href='/img/ko.ico?v=2')

block content

  .row
    .col-lg-8.col-lg-offset-2

      .text-center
        h3 Websites health checks
        hr
      
      if message && message.length
        .alert.alert-info
          p #{message}
      
      table.table.table-striped.table-hover
        thead
          tr
            th &nbsp;
            th Name
            th HTTP / Socket
            th Response time
            th Last check
            th.text-center Status
        tbody
          for url, name in websites
            tr
              td
                form(action='/delete', method='post')
                  input(type='hidden', name='_method', value='delete')
                  input(type='hidden', name='name', value=name)
                  button.btn.btn-xs(type='submit')
                    span.text-muted.glyphicon.glyphicon-trash
              td
                a(href='#{url}', target='_blank') #{name}
              td #{statuses[name] && statuses[name][1]}
              td #{statuses[name] && statuses[name][3]} ms
              td #{statuses[name] && statuses[name][2]}
              td.text-center
                if statuses[name] && statuses[name][0] === 'ok'
                  if statuses[name] && statuses[name][2] > timeout_ms
                    span.text-warning.glyphicon.glyphicon-time
                  else
                    span.text-success.glyphicon.glyphicon-ok
                else
                  span.text-danger.glyphicon.glyphicon-remove


      p.text-center.text-muted
        input#autorefresh(type='checkbox', value='1', checked='checked')
        | &nbsp;Autorefresh (every 5s)
        
        
  script.
    setInterval(function () {
      if (document.querySelector('#autorefresh').checked) {
        window.location.reload();
      }
    }, 5000);